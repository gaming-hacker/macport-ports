# -*- coding: utf-8; mode: _tcl; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- vim:fenc=utf-8:ft=tcl:et:sw=2:ts=2:sts=2

PortSystem          1.0

name                parallel
version             20211122
revision            0
checksums           rmd160  9f168eedfb18506b9c2e7550a00a733819fc020c \
sha256  48b256322c56a4cb1a7818fe0894fdde575dab0e0f925c6a2289517b6bd8962e \
size    2267617

categories          sysutils
platforms           darwin
license             GPL-3+
maintainers         {ciserlohn @ci42}
supported_archs     noarch

description         GNU parallel: Shell command parallelization utility

long_description    Build and execute shell command lines from standard input in parallel

homepage            https://www.gnu.org/software/parallel/
master_sites        gnu
use_bzip2           yes

depends_lib         port:perl5

<<<<<<< HEAD
checksums           rmd160  0cdc3d4ab93ab4d4588bcb8408835619d11d6d69 \
sha256  2810412b616b59dcf6a6bd172f2b2561807cf370ccf93417aa1c8229f94c4172 \
size    2101918

=======
>>>>>>> df887e97d3f7fddb142e8a9f96fe0e2dc00d0ad7
post-patch {
    set perl_bin ${prefix}/bin/perl
    set src_dir ${worksrcpath}/src/
    foreach f [list ${src_dir}niceload ${src_dir}sql ${src_dir}parallel.pod \
                   ${src_dir}niceload.pod ${src_dir}sem.pod ] {
        reinplace "s|/usr/bin/perl|${perl_bin}|" ${f}
    }
    foreach f [list ${src_dir}sem ${src_dir}parallel] {
        reinplace "s|/usr/bin/env perl|${perl_bin}|" ${f}
    }
    foreach f [list ${src_dir}parallel ${src_dir}parallel.1 \
                   ${src_dir}parallel.pod ${src_dir}parallel.html \
                   ${src_dir}sql ${src_dir}sem ${worksrcpath}/NEWS] {
        reinplace "s|/usr/bin/parallel|${prefix}/bin/parallel|" ${f}
    }
}

build.env-append    HOME=${workpath} SHELL=sh
