# -*- coding: utf-8; mode: _tcl; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- vim:fenc=utf-8:ft=tcl:et:sw=2:ts=2:sts=2

PortSystem          1.0
PortGroup           github 1.0

github.setup        GoogleContainerTools skaffold 1.30.0 v
revision            0

categories          devel
maintainers         {breun.nl:nils @breun} openmaintainer
platforms           darwin
license             Apache-2

description         Skaffold is a command line tool that facilitates continuous development for Kubernetes applications

long_description    Skaffold is a command line tool that facilitates continuous development for Kubernetes applications. \
                    You can iterate on your application source code locally then deploy to local or remote Kubernetes clusters. \
                    Skaffold handles the workflow for building, pushing and deploying your application. \
                    It also provides building blocks and describe customizations for a CI/CD pipeline.

homepage            https://skaffold.dev

github.tarball_from archive

checksums           rmd160  653637fa917a3630145ed4e83c052b1b84bab432 \
sha256  3a40dc813a1e6ca786566c3eb3c6099aadb66e590798bc8bcd774aa09357b764 \
size    18130188

depends_build       port:go

use_configure       no

build.env-append    VERSION=${version}
build.target

destroot {
    xinstall -m 0755 ${worksrcpath}/out/${name} ${destroot}${prefix}/bin/${name}

    # bash completion
    xinstall -d ${destroot}${prefix}/etc/bash_completion.d
    system "${destroot}${prefix}/bin/${name} completion bash > ${destroot}${prefix}/etc/bash_completion.d/${name}"

    # zsh completion
    xinstall -d ${destroot}${prefix}/share/zsh/site-functions
    system "${destroot}${prefix}/bin/${name} completion zsh > ${destroot}${prefix}/share/zsh/site-functions/_${name}"
}

# Disable update check: https://skaffold.dev/docs/references/privacy/#update-check
notes "
To disable automatic update checks, you have two options:

  1. set the SKAFFOLD_UPDATE_CHECK environment variable to false, e.g. in your shell profile:

     export SKAFFOLD_UPDATE_CHECK=false

  2. turn it off in skaffoldâ€™s config (~/.skaffold/config) with:

     skaffold config set -g update-check false
"
